## Postman-коллекция для проверки API

Файл `foodgram.postman_collection.json` содержит postman-коллекцию — набор заранее подготовленных запросов для проверки работы API проекта.

### Подготовка к тестированию API

Для корректного запуска тестов необходимо подготовить окружение и базу данных.

1.  **Настройте переменные окружения.**
    Убедитесь, что вы находитесь в корневой директории проекта. Создайте файл `.env` внутри папки `backend/` со следующим содержимым. Эти настройки предполагают локальное развертывание PostgreSQL.

    ```bash    
    SECRET_KEY='ваш_секретный_ключ'
    DEBUG=True

    DB_ENGINE=django.db.backends.postgresql
    DB_NAME=foodgram_db
    DB_USER=foodgram_user
    DB_PASSWORD=foodgram_password
    DB_HOST=localhost
    DB_PORT=5432

    POSTGRES_DB=foodgram_db
    POSTGRES_USER=foodgram_user
    POSTGRES_PASSWORD=foodgram_password
    ```

2.  **Перейдите в директорию бэкенда.**
    Все последующие команды выполняются из папки `backend/`.

    ```bash
    cd backend
    ```

3.  **Примените миграции.**
    Эта команда создаст все необходимые таблицы в вашей базе данных.

    ```bash
    python manage.py migrate
    ```

4.  **Подготовьте данные для тестов.**
    Запустите специальную команду, которая очистит базу данных и наполнит её необходимыми для тестов данными (теги и ингредиенты).

    ```bash
    python manage.py prep_tests
    ```
    Вы должны увидеть сообщение об успешной загрузке данных.

5.  **Запустите сервер.**
    Теперь ваш API готов к приёму запросов.

    ```bash
    python manage.py runserver
    ```

### Загрузка коллекции в Postman

1.  Запустите Postman.
2.  В левом верхнем углу нажмите `File` -> `Import`.
3.  Во всплывающем окне перетащите файл `foodgram.postman_collection.json` или выберите его через файловый менеджер.

### Запуск коллекции

1.  После импорта в левой части окна Postman во вкладке `Collections` появится коллекция `diploma`.
2.  Наведите на неё курсор, нажмите на три точки и в выпадающем списке выберите `Run`.
3.  В центре экрана отобразится результат запуска. Провалившиеся тесты можно отфильтровать, перейдя во вкладку `Failed`. Чтобы посмотреть детали выполненного запроса и полученного ответа, нажмите на название любого теста в списке.

### Повторный запуск коллекции

При каждом запуске тестов в базе данных создаются новые объекты (пользователи, рецепты и т.д.). Чтобы следующий запуск был корректным, базу данных необходимо вернуть в исходное состояние.

Для этого просто повторите шаг 4 из раздела подготовки:

```bash
python manage.py prep_tests
```
Эта команда удалит все тестовые данные и заново создаст необходимые для прогона тегов и ингредиентов. После этого можно снова запускать коллекцию в Postman.

### Ограничения от разработчиков Postman
В бесплатной версии программы Postman есть техническое ограничение: коллекцию можно беспрепятственно запускать 25 раз в месяц.
После исчерпания этого лимита Postman не превратится в тыкву: он по-прежнему будет запускать коллекции, но запуск иногда будет блокироваться на 30 секунд (иногда дважды подряд), и в это время в интерфейсе программы будет появляться предложение приобрести платную версию.
Вы можете купить платную версию, а можете просто продолжить пользоваться бесплатной версией, время от времени прерываясь на просмотр рекламы.

Для отправки отдельных запросов никаких ограничений нет.
