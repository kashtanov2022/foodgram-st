# Foodgram - Платформа для публикации рецептов

Foodgram — это веб-сервис, где пользователи могут публиковать свои кулинарные рецепты, добавлять рецепты других авторов в избранное, подписываться на интересных кулинаров и создавать персональный список покупок на основе выбранных рецептов.

## Особенности

*   **Публикация рецептов:** Пользователи могут создавать, редактировать и удалять собственные рецепты, указывая ингредиенты, описание, время приготовления и прикрепляя фото.
*   **Социальные функции:** Подписка на авторов, добавление рецептов в избранное.
*   **Список покупок:** Автоматическое формирование списка необходимых ингредиентов для выбранных рецептов с возможностью скачивания.
*   **Аутентификация и авторизация:** Регистрация, вход по email и паролю, использование токенов для API.
*   **Административная панель:** Управление пользователями, рецептами и другими данными через интерфейс Django Admin.

## Технологический стек

*   **Бэкенд:** Python, Django, Django REST framework, Djoser
*   **База данных:** PostgreSQL
*   **Фронтенд:** React
*   **Веб-сервер/Прокси:** Nginx
*   **Контейнеризация:** Docker, Docker Compose
*   **CI/CD:** Настроен через GitHub Actions

## Установка и запуск проекта в Docker

Для запуска проекта локально с использованием Docker и Docker Compose, выполните следующие шаги:

### Предварительные требования

*   Установленный Docker: [Инструкция по установке Docker](https://docs.docker.com/get-docker/)

### 1. Клонирование репозитория

Склонируйте репозиторий на ваш локальный компьютер:

```bash
git clone https://github.com/kashtanov2022/foodgram-st
cd foodgram-st
```

### 2. Создание файла `.env` для переменных окружения

В корневой директории проекта создайте файл `.env` и заполните его необходимыми переменными окружения.

Пример содержимого `.env`:

```env
SECRET_KEY='ваш_секретный_ключ'
DEBUG=True

DB_ENGINE=django.db.backends.postgresql
DB_NAME=foodgram_db
DB_USER=foodgram_user
DB_PASSWORD=foodgram_password
DB_HOST=db
DB_PORT=5432

POSTGRES_DB=foodgram_db
POSTGRES_USER=foodgram_user
POSTGRES_PASSWORD=foodgram_password
```
**Примечание:** `POSTGRES_USER` и `POSTGRES_PASSWORD` также используются образом PostgreSQL для инициализации базы данных. Убедитесь, что они совпадают с `DB_USER` и `DB_PASSWORD`, если вы хотите, чтобы Django подключался с теми же учетными данными, которые создает образ PostgreSQL.

### 3. Сборка и запуск Docker-контейнеров

Находясь в директории, где расположен `docker-compose.yml` (`infra/`), выполните команду:

```bash
docker-compose up --build -d
```

### 4. Вход в консоль управления

После того как контейнеры успешно запустятся, необходимо выполнить вход в консоль для первичной настройки.

Выполните команду в директории `infra/`:

```bash
docker exec -it foodgram_backend bash
```

### 5. Загрузка начальных данных

После входа в консоль, необходимо наполненить базу данных начальными данными с помощью следующей команды.

**ВАЖНО:** После запуска контейнеров **подождите примерно 30-60 секунд** перед выполнением этой команды, чтобы убедиться, что сервис PostgreSQL полностью инициализировался и готов принимать подключения. В противном случае база данных может не сразу подгрузить данные.

```bash
python manage.py load_data
```

### 6. Создание администратора

Для доступа к административной панели Django необходимо создать суперпользователя:

```bash
python manage.py createsuperuser
```

Вам будет предложено ввести имя пользователя, адрес электронной почты и пароль.

### 7. Доступ к приложению

После выполнения всех шагов:

*   **Фронтенд приложения** будет доступен по адресу: `http://localhost/`.
*   **Административная панель Django** будет доступна по адресу: `http://localhost/admin/`.
*   **Документация API** будет доступна по адресу: `http://localhost/api/docs/`.

### Остановка контейнеров

Чтобы остановить запущенные контейнеры:

```bash
docker-compose down
```

Если вы хотите очистить базу данных, то используйте:

```bash
docker volume rm infra_postgres_data
```

## Структура проекта

*   `backend/`: Django-приложение.
    *   `configuration/`: Основная конфигурация Django-проекта.
    *   `recipes/`: Приложение Django для рецептов, тегов, ингредиентов.
    *   `users/`: Приложение Django для управления пользователями и подписками.
    *   `manage.py`: Утилита командной строки Django.
    *   `Dockerfile`: Инструкции для сборки Docker-образа бэкенда.
*   `frontend/`: React SPA-приложение.
    *   `Dockerfile`: Инструкции для сборки статических файлов фронтенда.
*   `infra/`: Конфигурационные файлы для инфраструктуры.
    *   `nginx.conf`: Конфигурация Nginx.
    *   `docker-compose.yml`: Описание и запуск мультиконтейнерного приложения.
*   `data/`: Начальные данные для загрузки в БД.
*   `docs/`: Спецификация API.
*   `requirements.txt`: Зависимости Python приложения.

## Автор

*   [Каштанов Иван Александрович - kashtanov2022](https://github.com/kashtanov2022)
